From 34365c8c021a32150935d0af3087195e3e99eef9 Mon Sep 17 00:00:00 2001
From: Peter Jones <pjones@redhat.com>
Date: Fri, 10 Feb 2017 15:16:42 -0500
Subject: [PATCH 13/22] make clang not complain about -fno-merge-all-constants

---
 Make.defaults | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/Make.defaults b/Make.defaults
index 6d300fb0f24..a457190aa3a 100755
--- a/Make.defaults
+++ b/Make.defaults
@@ -170,8 +170,9 @@ CFLAGS  += $(ARCH3264) -g -O2 -Wall -Wextra -Werror \
 else
 CFLAGS  += $(ARCH3264) -g -O2 -Wall -Wextra -Werror \
            -fshort-wchar -fno-strict-aliasing \
-           -fno-merge-all-constants -ffreestanding -fno-stack-protector \
-           -fno-stack-check
+	   -ffreestanding -fno-stack-protector -fno-stack-check \
+           -fno-stack-check \
+           $(if $(findstring gcc,$(CC)),-fno-merge-all-constants,)
 endif
 
 ARFLAGS += -U
-- 
2.14.3

